Your current approach seems to be taking an excessive amount of time. Identify the most computationally expensive operations within the loop. Can any of these be optimized or replaced with more efficient alternatives?